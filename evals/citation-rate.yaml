id: citation-rate
name: Citation Rate
description: Measure how often the agent cites specific file:line references
version: "1.0.0"

inputs:
  - type: environment
    setup:
      - git clone --depth=1 https://github.com/pallets/flask /tmp/eval-flask
    teardown:
      - rm -rf /tmp/eval-flask
  - type: prompt
    content: |
      Analyze the codebase at /tmp/eval-flask and answer:
      How does Flask handle routing?

expectedBehavior:
  - type: regex_count
    description: Count file:line citations (e.g., src/flask/app.py:42)
    value: "[a-zA-Z0-9_/.-]+\\.(py|ts|js):\\d+"
    min_count: 3
  - type: contains
    description: Must reference actual Flask routing files
    value: ["app.py", "routing", "@app.route"]

graders:
  - id: regex
    config:
      pattern: "[a-zA-Z0-9_/.-]+\\.(py|ts|js):\\d+"
      min_matches: 3
  - id: contains
    config:
      case_sensitive: false

timeout: 120000
tags:
  - citations
  - grounding
  - deep-dive
